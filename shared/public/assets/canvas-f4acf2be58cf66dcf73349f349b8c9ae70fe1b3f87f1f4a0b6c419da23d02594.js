$(function(){function e(e){1==e?(o.globalCompositeOperation="source-over",$("#pencil").className="active",$("#eraser").className=""):2==e&&(o.globalCompositeOperation="destination-out",$("#pencil").className="",$("#eraser").className="active")}var t=document.getElementById("canvas");if(t.getContext){var o=t.getContext("2d");o.fillStyle="rgb(255,255,255)",o.fillRect(0,0,t.width,t.height)}var i=!1,n=0,a=0;$("#canvas").mousedown(function(e){i=!0,n=e.pageX-$(this).offset().left,a=e.pageY-$(this).offset().top}).mousemove(function(e){if(!i)return;let t=e.pageX-$(this).offset().left,s=e.pageY-$(this).offset().top,l=$("#width").val(),c=$("#color").val(),r=parseInt(c.substring(1,3),16),f=parseInt(c.substring(3,5),16),u=parseInt(c.substring(5,7),16);o.lineCap="round",o.strokeStyle="rgb("+r+","+f+","+u+")",o.lineWidth=l,o.beginPath(),o.moveTo(n,a),o.lineTo(t,s),o.stroke(),o.closePath(),n=t,a=s}).mouseup(function(){i=!1}).mouseleave(function(){i=!1}),$("#delete_canvas").click(function(){ret=confirm("canvas\u306e\u5185\u5bb9\u3092\u524a\u9664\u3057\u307e\u3059\u3002"),1==ret&&(o.fillStyle="rgb(255,255,255)",o.fillRect(0,0,t.width,t.height))}),$("#pencil").click(function(){e(1)}),$("#eraser").click(function(){e(2)}),$("form").click(function(){var e=t.toDataURL();$("#post_dataURI").val(e)})});